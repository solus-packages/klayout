name       : klayout
version    : '0.25.1'
release    : 2
source     :
    - http://www.klayout.org/downloads/source/klayout-0.25.1.tar.gz : 32dff0751cdb68c5ab0aeaa2fe561e75bdec0c6d6774c9c33923aebf97b006e4
license    :
    - GPL-2.0
summary    : Klayout GDS/OASIS editor.
component  : office.scientific
description: |
    High performance layout viewer and editor that supports GDS and OASIS files.
builddeps  :
    - pkgconfig(gl)
    - pkgconfig(harfbuzz)
    - pkgconfig(python-3.6)
    - pkgconfig(QtCore)
    - pkgconfig(ruby-2.3)
replaces   :
    - klayout-devel
setup      : |
    %patch -p1 < $pkgfiles/0001-use-qt4-specific-tool-names.patch
    ./build.sh -dry-run
build      : |
    cd build-release
    %make
install    : |
    ## Binaries
    install -D -d -m 00755 $installdir/usr/bin
    install -m 00755 build-release/{klayout,strm*} $installdir/usr/bin/.

    ## Libraries
    install -D -d -m 00755 $installdir/%libdir%
    install -m 00644 build-release/libklayout*.so.0   $installdir/%libdir%/.
    ## use cp+chmod because install resolve
    cp      -d       build-release/libklayout*.so.0.* $installdir/%libdir%/.
    chmod      00644                                  $installdir/%libdir%/libklayout*.so.0.*

    ## Menu Files    
    install -D -m 00644 etc/logo.png $installdir/usr/share/pixmaps/klayout.png
    install -D -m 00644 $pkgfiles/klayoutEditor.desktop $installdir/usr/share/applications/klayoutEditor.desktop
    install -D -m 00644 $pkgfiles/klayoutViewer.desktop $installdir/usr/share/applications/klayoutViewer.desktop
